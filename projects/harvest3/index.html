<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Madhava  Paliyam


  | Street2Sat

</title>
<meta name="description" content="A beautiful, simple, clean, and responsive Jekyll theme for academics">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ¥­</text></svg>">

<link rel="stylesheet" href="/madhava.github.io/assets/css/main.css">
<link rel="canonical" href="/madhava.github.io/projects/harvest3/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/madhava.github.io/assets/js/theme.js"></script>
<script src="/madhava.github.io/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/madhava.github.io/">
       <span class="font-weight-bold">Madhava</span>   Paliyam
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/madhava.github.io/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/madhava.github.io/publications/">
                
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/madhava.github.io/mridangam/">
                mridangam
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/madhava.github.io/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/madhava.github.io/resumeandreports/">
                resume and reports
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Street2Sat</h1>
    <p class="post-description">Machine learning pipeline for creating ground truth geo-referenced labeled datasets from street level images.</p>
  </header>

  <article>
    <p>PAPER ACCEPTED TO ICML CLIMATE CHANGE <a href="https://www.climatechange.ai/papers/icml2021/74">WORKSHOP</a></p>

<p>Code available <a href="https://github.com/nasaharvest/street2sat_website/tree/ICML_paper_code"> here. </a></p>

<p>(Still in development, our team is working on deploying to google cloud and on a web app)</p>

<h5 id="skills-used-">Skills used:</h5>

<li>Deploying deep learning models on a web app using Heroku and Flask</li>
<li>Training Yolo object detection on hand labeled images</li>
<li>MongoDB for data storage</li>

<p></p>
<p>
Ground-truth labels on crop type and other variables are critically needed to develop machine learning methods that use satellite observations to combat climate change and food insecurity. These labels difficult and costly to obtain over large areas, particularly in Sub-Saharan Africa where they are most scarce. I wrote code for Street2Sat, a new framework for obtaining large data sets of geo-referenced crop type labels obtained from vehicle mounted cameras that can be extended to other applications.
</p>

<p>The Street2Sat pipeline has 5 steps:</p>
<li>Data Collection drives</li>
<li>Image Preprocessing</li>
<li>Crop Type Prediction</li>
<li>Distance Estimation</li>
<li>GPS Coordinate Correction</li>

<p></p>
<h5 id="Data Collection">Data Collection</h5>
<p>Data was collected in Western Kenya using car mounted GoPro Cameras. This study will be extended to 5 more countries in the near future.</p>

<div class="row justify-content-sm-center">
    <div class="col-sm-8 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/GP__0633.JPG" alt="" title="example image" />
    </div>
    <div class="col-sm-4 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/gopro.jpeg" alt="" title="example image" />
    </div>
</div>
<div class="caption">
    Left: Example Image from Data Collection. Right: GoPro 360 camera that was used.
</div>

<h5 id="Image Processing">Image Processing</h5>

<p>An iterated approach on <a href="https://en.wikipedia.org/wiki/Otsu%27s_method">Otsuâ€™s Method</a> for thresholding was used to straighten images before they were used to train the Yolo object detection. Otsuâ€™s method was run on the whole image, halves of the image, thirds of the image, and fourths of the image, and all the predicted rotation angles were averaged. In addition, the image was blurred using a gaussian filter before running on Otsuâ€™s method in order to reduce incorrect rotations resulting from small objects.</p>
<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/line.png" alt="" title="example image" />
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/falsecolor.png" alt="" title="example image" />
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/straight.png" alt="" title="example image" />
    </div>
</div>
<div class="caption">
Left is original image with predicted rotation angle. Middle is blurred image used in Otsu's method. Right is the rotated image.
</div>

<h5 id="pred">Crop Type Prediction</h5>

<p>The <a href="https://github.com/ultralytics/yolov5">Yolo Object Detection</a> framework is used to train and predict where crops were located in the image. The images were labeled for crop type by Nasa Harvest teams with agricultural expert guidance. The trained Yolo model is hosted on Heroku using Flask and MongoDB. The crop type prediction can be run on the web app.</p>

<div class="row justify-content-sm-center">
    <div class="col">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/GP__0633.JPG" alt="" title="example image" />
    </div>
    <div class="col">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/predictions-s2s.png" alt="" title="example image" />
    </div>
</div>
<div class="caption">
    Left: Original Image. Right: Predicted crop type.
</div>

<h5 id="pred">Distance Estimation</h5>

<p>The heights of the predicted bounding boxes are used to predict the distance from the camera to the crop. We calculated the distance to each bounding box and then calculated the average depth for all of the boxes of the same crop type class to get a single depth for the field. We used the following equation to predict distance:</p>

\[\begin{equation}
    d = \frac{(l_{focal} * h_{crop} * h_{image})}{(h_{bbox} * h_{sensor})}
\end{equation}\]

<p>The focal length, \(l_{focal}\), was obtained from the EXIF image metadata; the crop height, \(h_{crop}\), is from known heights of crops; \(h_{bbox}\) is the height of the bounding box in pixels; \(h_{image}\) is the height of the image in pixels; and the GoPro sensor height \(h_{sensor}\) is 4.55 mm.</p>

<h5 id="gps">GPS Coordinate Estimation</h5>

<p>After obtaining the average distance to the crop in the image, the bearing of the camera had to be calculated. To find the bearing, a velocity vector is calculated between the current image and the closest other image in time that is uploaded. We assume that the camera is pointed 90 degrees orthogonal to the drive direction and relocate the point the average distance in that direction.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/madhava.github.io/assets/img/pointss2s.png" alt="" title="example image" />
    </div>
</div>
<div class="caption">
    Predicted points in red. Original points in grey.
</div>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2021 Madhava  Paliyam.
    
    
    
    Last updated: September 14, 2021.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/madhava.github.io/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/madhava.github.io/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/madhava.github.io/assets/js/common.js"></script>


</html>
